<!-- select-quang-dialog.component.html -->
<h2 mat-dialog-title>Chọn quặng nguồn</h2>

<mat-dialog-content>
  <mat-form-field appearance="outline" style="width:100%; margin-bottom:8px;">
    <mat-label>Tìm kiếm</mat-label>
    <input matInput [formControl]="q" placeholder="Tên / mã" />
  </mat-form-field>

  <div class="table-wrap">
    <table mat-table [dataSource]="(rows$ | async) ?? []" [trackBy]="trackById" class="w-100">
      <ng-container matColumnDef="sel">
        <th mat-header-cell *matHeaderCellDef style="width:56px;"></th>
        <td mat-cell *matCellDef="let r">
          <mat-checkbox [checked]="isChecked(r.id)" (change)="toggle(r)"></mat-checkbox>
        </td>
      </ng-container>

      <ng-container matColumnDef="code">
        <th mat-header-cell *matHeaderCellDef>Mã</th>
        <td mat-cell *matCellDef="let r">{{ r.maQuang }}</td>
      </ng-container>

      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef>Tên</th>
        <td mat-cell *matCellDef="let r">{{ r.tenQuang }}</td>
      </ng-container>

      <ng-container matColumnDef="price">
        <th mat-header-cell *matHeaderCellDef>Giá</th>
        <td mat-cell *matCellDef="let r">{{ r.gia ?? 0 | number }}</td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="cols"></tr>
      <tr mat-row *matRowDef="let row; columns: cols"></tr>
    </table>
  </div>

  <mat-paginator
    [length]="total()"
    [pageIndex]="searchPayload.pageIndex"
    [pageSize]="searchPayload.pageSize"
    [pageSizeOptions]="[5,10,25,50]"
    (page)="onPage($event)">
  </mat-paginator>

  <div class="loading" *ngIf="loading()">Đang tải...</div>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-stroked-button (click)="close()">Huỷ</button>
  <button mat-flat-button color="primary" (click)="confirm()">Xác nhận</button>
</mat-dialog-actions>
